## MITRE | ATT&CK <a href="https://attack.mitre.org/techniques/T1566/001/">T1566.001</a>
### Tactic: Initial Access 
#### Scenario objective
The objective of this scenario is early detection of malicious files before execution.
This is achieved through VirusTotal integration, real-time File Integrity Monitoring (FIM), and an automated response that removes the infected file.
#### Scenario
The user downloaded a malicious file from an untrusted source or received it via a phishing email, after which the file was saved in the Downloads folder.
This scenario reflects one of the most common real-world infection vectors observed in enterprise environments.
#### Walkthrough 

<b>1.</b> Adding folder monitoring on Windows host in agent.conf   

```
  <agent_config os="Windows">
    <syscheck>
      <directories check_all="yes" realtime="yes"> C:\Downloads </directories>
    </syscheck>
  </agent_config>
```
alert ⚠ Check.
<img width="1280" height="448" alt="image" src="https://github.com/user-attachments/assets/4f6b59b9-2950-4e93-9304-eb804c9ae2ef" />

<b>2. VirusTotal integration to Wazuh server</b>
<p><b>Requierments: VirusTotal API_KEY</b>
  
```
<integration>
  <name>virustotal</name>
  <api_key>API_KEY</api_key> <!-- Replace with your VirusTotal API key -->
  <group>syscheck</group>
  <alert_format>json</alert_format>
</integration>
```

Integration Check ⚠ 
<img width="951" height="686" alt="image" src="https://github.com/user-attachments/assets/d7c438be-c399-4a69-8ff7-3878aafdc919" />
